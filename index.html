<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TERMINAL_RESIDENCE_FINAL_BUILD</title>
    <style>
        :root { --neon: #00ff41; --bg: #000a00; --white: #e0e0e0; --red: #ff0000; }
        body { 
            background: var(--bg); color: var(--neon); 
            font-family: 'Consolas', 'Courier New', monospace; 
            padding: 10px; margin: 0; height: 100vh; overflow: hidden;
            font-size: 11px; line-height: 1.1;
        }
        #console { border: 2px solid #004400; padding: 10px; height: 94vh; display: flex; flex-direction: column; position: relative; box-shadow: inset 0 0 50px #000; overflow: hidden; transition: border-color 0.3s;}
        .line { margin-bottom: 2px; white-space: pre-wrap; text-transform: uppercase; }
        .prompt-user { color: var(--white); background: rgba(0, 255, 65, 0.2); padding: 5px; font-weight: bold; border-left: 3px solid var(--white); }
        .prompt-console { color: var(--neon); border-left: 4px solid var(--neon); padding-left: 6px; margin: 8px 0; background: rgba(0, 40, 0, 0.3);}
        .red { color: var(--red); font-weight: bold; text-shadow: 0 0 10px var(--red); }
        .centered-ui { display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 5px 0; }
        
        .notice-box {
            border: 1px double var(--neon);
            background: rgba(0, 30, 0, 0.8);
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            width: 90%;
        }

        #scanner-container {
            position: relative; border: 4px solid #005500; opacity: 0.1; pointer-events: none;
            background: rgba(0, 60, 0, 0.2); width: 130px; height: 140px; display: flex; align-items: center; justify-content: center;
            margin-top: 10px; box-shadow: 0 0 20px rgba(0,255,65,0.1);
        }
        #scanner-dots { font-size: 22px; line-height: 0.7; letter-spacing: 6px; color: #00ff41; user-select: none; opacity: 0.5; }
        #laser { position: absolute; width: 100%; height: 4px; background: #fff; box-shadow: 0 0 25px var(--neon), 0 0 10px #fff; top: 0; left: 0; display: none; z-index: 20; }
        
        button { 
            background: #002200; color: var(--neon); border: 2px solid var(--neon); 
            padding: 16px 24px; font-family: 'Consolas', monospace; cursor: pointer;
            text-transform: uppercase; font-weight: bold; font-size: 13px;
            box-shadow: 6px 6px 0 #004400; transition: all 0.1s;
        }
        button:hover:not(:disabled) { background: var(--neon); color: #000; box-shadow: none; transform: translate(3px, 3px); }
        button:disabled { border-color: #003300; color: #003300; opacity: 0.4; box-shadow: none; }
        
        #prog-bar { color: var(--white); font-size: 12px; margin-bottom: 5px; font-weight: bold; text-shadow: 0 0 5px var(--neon); }
        
        #telemetry-box { 
            font-size: 9px; color: #00ff41; height: 60px; overflow: hidden; width: 100%; 
            border-top: 1px solid #00ff41; margin-top: 5px; background: rgba(0,10,0,0.9); 
            padding: 5px; font-family: 'Courier New';
        }

        #countdown { font-size: 1.5em; color: #fff; border: 2px solid var(--red); padding: 15px; margin: 15px 0; background: rgba(40,0,0,0.5); text-align: center; font-weight: bold; letter-spacing: 2px; }
        
        .footer-info { 
            font-size: 11px; color: var(--neon); margin-top: 10px; font-weight: bold; 
            text-align: center; border-top: 1px dashed #004400; width: 100%; padding-top: 10px;
        }

        .hidden { display: none; }
        @keyframes scanMotion { 0% { top: 0%; } 100% { top: 100%; } }
        .glitch-active { animation: glitch 0.05s infinite; background: #300 !important; }
        @keyframes glitch { 0% { transform: translate(3px, 0); } 50% { transform: translate(-3px, 2px); } 100% { transform: translate(0, -2px); } }
    </style>
</head>
<body>

    <div id="console">
        <div id="init-screen">
            <div id="init-logs"></div>
            <div class="centered-ui">
                <div class="line red" style="font-size: 16px; border: 2px solid red; padding: 10px;">[!] ALERTA: PROTOCOLO AUDITIVO REQUERIDO [!]</div>
                <div class="notice-box">
                    <span style="color:#fff;">SISTEMA DE SEGURIDAD BIOMÉTRICA</span><br>
                    POR FAVOR, ASEGÚRESE DE QUE SU VOLUMEN ESTÉ AL MÁXIMO NIVEL.
                </div>
                <button id="btn-init" class="hidden" onclick="playClick(); initApp()">> ACCEDER_AL_SISTEMA.EXE</button>
            </div>
        </div>

        <div id="boot-screen" class="hidden">
            <div id="boot-header" style="color: #fff; font-size: 11px; border-bottom: 1px solid #00ff41; padding-bottom: 5px; margin-bottom: 10px;"></div>
            <div id="boot-logs" style="height: 180px; overflow: hidden; padding: 5px;"></div>
            <div class="centered-ui">
                <div class="notice-box" style="font-size: 10px; border-color: #fff;">
                    INSTRUCCIÓN: ESCUCHE EL MENSAJE Y PRESIONE EL BOTÓN INFERIOR PARA INICIAR EL ESCANEO.
                </div>
                <button id="btn-start-scan" disabled onclick="playClick(); startScanningSequence()">> INICIALIZAR_BIOMETRIC_SCAN.exe</button>
                <div class="footer-info">PROPIEDAD DE DIEGO BELEÑO © 2026 - ACCESO RESTRINGIDO</div>
            </div>
        </div>

        <div id="scan-screen" class="hidden">
            <div id="scan-logs" style="height: 180px; overflow-y: auto; font-size: 11px; border-bottom: 1px solid #005500;"></div>
            <div class="centered-ui">
                <div id="prog-bar">STATUS: ESPERANDO HUELLA...</div>
                <div id="scanner-container">
                    <div id="laser"></div>
                    <div id="scanner-dots">::::<br>::::<br>::::<br>::::<br>::::</div>
                </div>
                <div id="telemetry-box"></div>
                <div class="footer-info">AUTORIZACIÓN REQUERIDA: DIEGO BELEÑO © 2026</div>
            </div>
        </div>

        <div id="result-screen" class="hidden">
            <div class="line" style="background:var(--neon); color:#000; padding: 6px; font-weight:bold; font-size: 14px; text-align: center;">IDENTIDAD CONFIRMADA: <span id="decrypt-name"></span></div>
            <div id="final-text-area" style="font-size: 11px; margin-top: 15px; border-left: 2px solid var(--neon); padding-left: 10px;"></div>
            <div id="countdown"></div>
            <div class="line red" style="text-align: center; margin-bottom: 8px;">¡ADVERTENCIA! ACCIÓN REQUERIDA:</div>
            <button id="btn-conf" disabled onclick="playClick(); startVirusBroma()">> ENVIAR_CONFIRMACIÓN_FINAL.EXE</button>
            <div id="virus-logs" class="red" style="margin-top:15px; font-size: 10px;"></div>
            <div class="footer-info" style="color: #ff0000; border-color: #ff0000;">© 2026 DIEGO BELEÑO - SISTEMA DE INVITACIONES</div>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const rawNombre = (urlParams.get('nombre') || "INVITADO_ANÓNIMO");
        let audioCtx, scanOsc, scanMod, timer, count = 0;
        
        let activeSteps = [];
        const originalSteps = [
            {p: 0, v: "ESCANEANDO HUELLA DIGITAL..."},
            {p: 15, v: "MIDIENDO PULSO CARDIACO..."},
            {p: 25, v: "ENVIANDO INFROMACIÓN A LA BASE DE DATOS..."},
            {p: 40, v: "GUARDANDO DATOS DE USUARIO..."},
            {p: 50, v: "GUARDANDO DATOS DE USUARIO..."},
            {p: 85, v: "BORRANDO TIKTOK DEL DISPOSITIVO..."},
            {p: 98, v: "ACCESO CONCEDIDO CON ÉXITO."}
        ];

        function playAggressiveSound(freq, duration, type='square', vol=0.1) {
            if(!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            const filter = audioCtx.createBiquadFilter();

            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            filter.type = "lowpass"; 
            filter.frequency.value = 2000;

            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);

            osc.connect(filter);
            filter.connect(gain);
            gain.connect(audioCtx.destination);

            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function playClick() { playAggressiveSound(1200, 0.05, 'square', 0.1); }
        function playUnlock() { 
            playAggressiveSound(880, 0.1, 'square', 0.1); 
            setTimeout(() => playAggressiveSound(1760, 0.1, 'square', 0.1), 100);
        }

        function speakAndType(text, targetId, prompt, callback) {
            if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
            const el = document.createElement("div");
            el.className = "line " + (prompt === 'user' ? 'prompt-user' : 'prompt-console');
            const target = document.getElementById(targetId);
            target.appendChild(el);
            target.scrollTop = target.scrollHeight;
            
            let i = 0;
            const typeInterval = setInterval(() => {
                if(i < text.length) {
                    el.innerHTML = (prompt === 'user' ? "> " : "") + text.substring(0, i+1);
                    playAggressiveSound(150 + (Math.random()*30), 0.02, 'triangle', 0.05);
                    i++;
                } else { clearInterval(typeInterval); }
            }, 25);

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'es-MX'; utterance.rate = 1.0; utterance.pitch = 0.4;
            utterance.onend = () => { 
                clearInterval(typeInterval); 
                el.innerHTML = (prompt === 'user' ? "> " : "") + text;
                if(callback) callback(); 
            };
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
        }

        window.onload = async () => {
            const boot = ["LOADER_V2.0_POWERED_BY_BELEÑO", "ENCRYPT_STK: ENABLED", "SOUND_ENGINE: MAX_THRASH", "READY FOR SCAN..."];
            for(let l of boot) {
                const d = document.createElement("div"); d.innerText = l;
                document.getElementById("init-logs").appendChild(d);
                await new Promise(r => setTimeout(r, 60));
            }
            document.getElementById("btn-init").classList.remove("hidden");
        };

        async function initApp() {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            document.getElementById("init-screen").classList.add("hidden");
            document.getElementById("boot-screen").classList.remove("hidden");
            await typeSimple("TERMINAL SECURE ACCESS - PROTOCOLO V.26", "boot-header");
            
            const msg = "SISTEMA DE SEGURIDAD INICIADO CON ÉXITO. RECUERDE MANTENER EL VOLUMEN AL MÁXIMO. NECESITAMOS SUS DATOS BIOMÉTRICOS PARA LA CREACIÓN DE SU PERFIL DE USUARIO EN LA BASE DE DATOS. SE LE REALIZARÁ UN ESCÁNER DIGITAL. PRESIONE EL BOTÓN INICIAR BIOMETRIC ESCAN PUNTO EXE PARA CONTINUAR.";
            speakAndType(msg, "boot-logs", 'user', () => { 
                document.getElementById("btn-start-scan").disabled = false;
                playUnlock();
            });
        }

        function startScanningSequence() {
            activeSteps = [...originalSteps];
            document.getElementById("boot-screen").classList.add("hidden");
            document.getElementById("scan-screen").classList.remove("hidden");
            
            const msg = "COLOQUE SU HUELLA FIRMEMENTE SOBRE EL LECTOR. MANTENGA LA PRESIÓN HASTA QUE LA BARRA LLEGUE AL CIEN POR CIENTO. POR FAVOR NO RETIRE EL DEDO HASTA COMPLETAR EL PROCESO.";
            speakAndType(msg, "scan-logs", 'console', () => {
                playUnlock(); // Sonido de que el lector está disponible
                document.getElementById("scanner-container").style.opacity = "1";
                document.getElementById("scanner-container").style.pointerEvents = "auto";
                document.getElementById("prog-bar").innerText = "STATUS: LECTOR LISTO - ESPERANDO CONTACTO";
            });
        }

        function triggerScan(e) {
            e.preventDefault();
            if (count >= 100 || scanOsc) return;

            scanOsc = audioCtx.createOscillator();
            scanMod = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            const modGain = audioCtx.createGain();

            // Sonido de escáner más industrial (Sierra + Cuadrada)
            scanOsc.type = 'sawtooth';
            scanOsc.frequency.value = 60; 
            scanMod.frequency.value = 15; // Modulación más rápida
            modGain.gain.value = 30;

            scanMod.connect(modGain);
            modGain.connect(scanOsc.frequency);
            gain.gain.value = 0.07;
            scanOsc.connect(gain);
            gain.connect(audioCtx.destination);

            scanOsc.start();
            scanMod.start();
            
            document.getElementById("laser").style.display = "block";
            document.getElementById("laser").style.animation = "scanMotion 1.2s infinite alternate ease-in-out";
            
            timer = setInterval(() => {
                count += 0.45; 
                const cur = Math.min(Math.floor(count), 100);
                document.getElementById("prog-bar").innerText = `ANALIZANDO... [${"█".repeat(Math.floor(cur/10))}${"░".repeat(10-Math.floor(cur/10))}] ${cur}%`;
                
                if(cur >= 100) { 
                    stopScanAudio();
                    playUnlock(); // Sonido de éxito de hardware
                    document.getElementById("laser").style.display = "none";
                    speakAndType("PROCESO COMPLETADO. IDENTIDAD CONFIRMADA. BIENVENIDO " + rawNombre, "scan-logs", 'console', () => {
                        showResult();
                    });
                    clearInterval(timer);
                    return; 
                }
                
                if(activeSteps.length > 0 && cur >= activeSteps[0].p) {
                    speakAndType(activeSteps.shift().v, "scan-logs", 'console');
                }

                if(cur % 3 === 0) {
                    const hex = Array.from({length:6}, () => Math.floor(Math.random()*256).toString(16).toUpperCase().padStart(2,'0')).join(':');
                    const telemetry = [`PACKET_LOST: 0%`, `CORE_TEMP: 88°C`, `MAC_ADDR: ${hex}`, `SIGNAL_STRENGTH: -${(Math.random()*100).toFixed(0)}dBm`];
                    const tBox = document.getElementById("telemetry-box");
                    tBox.innerHTML = `<div>> ${telemetry[Math.floor(Math.random()*telemetry.length)]}</div>` + tBox.innerHTML;
                }
            }, 100);
        }

        function stopScanAudio() {
            if(scanOsc) { scanOsc.stop(); scanOsc = null; }
            if(scanMod) { scanMod.stop(); scanMod = null; }
        }

        const endScan = () => { 
            if(count < 100) { 
                clearInterval(timer); 
                stopScanAudio();
                document.getElementById("laser").style.display = "none"; 
                playAggressiveSound(60, 0.8, 'square', 0.3); 
                document.getElementById("console").style.borderColor = "#ff0000";
                setTimeout(() => document.getElementById("console").style.borderColor = "#004400", 600);
                speakAndType("ERROR CRÍTICO: CONTACTO INTERRUMPIDO. REINICIANDO NODO...", "scan-logs", 'console');
                count = 0; 
                activeSteps = [...originalSteps];
                document.getElementById("prog-bar").innerText = `STATUS: ESCANEO FALLIDO - REINTENTE`;
                document.getElementById("telemetry-box").innerHTML = ""; 
            } 
        };

        function showResult() {
            document.getElementById("scan-screen").classList.add("hidden");
            document.getElementById("result-screen").classList.remove("hidden");
            document.getElementById("decrypt-name").innerText = rawNombre.toUpperCase();
            
            const msg = "ATENCIÓN " + rawNombre + ". ESTÁS INVITADO AL CUMPLEAÑOS DE DIEGO ESTE SÁBADO 7 DE FEBRERO A LAS 6 PM EN SU RESIDENCIA. EL CÓDIGO DE VESTIMENTA ES OBLIGATORIO. CONSEJO: USA PANTALONES ANCHOS, ZAPATOS BLANCOS, GORRAS Y CAMISETAS ENCIMA DE OTRAS CAMISETAS MANGA LARGA. CONFIRMA TU ASISTENCIA AHORA PRESIONANDO ENVIAR CONFIRMACIÓN FINAL PUNTO EXE.";
            speakAndType(msg, "final-text-area", 'console', () => {
                document.getElementById("btn-conf").disabled = false;
                playUnlock();
            });
            setInterval(updateClock, 1000);
        }

        function updateClock() {
            const diff = new Date('February 7, 2026 18:00:00').getTime() - new Date().getTime();
            const d = Math.floor(diff/86400000), h = Math.floor((diff%86400000)/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
            document.getElementById("countdown").innerText = `T-MINUS: ${d}D ${h}H ${m}M ${s}S`;
        }

        function startVirusBroma() {
            document.body.classList.add("glitch-active");
            playAggressiveSound(30, 2.0, 'sawtooth', 0.5);
            const msg = "VIRUS INSTALADO. DISPOSITIVO COMPROMETIDO. LOS DATOS SERÁN CIFRADOS. PARA DESINFECTAR SU DISPOSITIVO, DEBE ASISTIR A LA REUNIÓN Y SEGUIR LAS INSTRUCCIONES. REDIRECCIONANDO A CENTRAL DE CONFIRMACIÓN, ESPERE";
            speakAndType(msg, "virus-logs", 'console', () => {
                setTimeout(() => {
                    window.location.href = "https://wa.me/584246603660?text=" + encodeURIComponent("ASISTENCIA CONFIRMADA POR: " + rawNombre + ". MI DISPOSITIVO HA SIDO INFECTADO.");
                }, 2500);
            });
            setInterval(() => {
                const el = document.createElement("div"); 
                el.className = "red";
                el.innerText = "OVERRIDE_AUTH_ERROR_0x" + Math.random().toString(16).slice(2,8).toUpperCase();
                document.getElementById("virus-logs").prepend(el);
            }, 80);
        }

        async function typeSimple(t, id) {
            const el = document.createElement("div"); el.className = "line";
            document.getElementById(id).appendChild(el);
            for(let c of t) { el.innerHTML += c; await new Promise(r => setTimeout(r, 30)); }
        }
        
        const scanEl = document.getElementById("scanner-container");
        scanEl.addEventListener('touchstart', triggerScan); 
        scanEl.addEventListener('mousedown', triggerScan); 
        scanEl.addEventListener('touchend', endScan);
        scanEl.addEventListener('mouseup', endScan);
    </script>
</body>
</html>

